// AUTO-GENERATED by scripts/generate-optional-modules.mjs. Do not edit manually.

import type { ComponentType } from "react";
import type { LucideIcon } from "lucide-react";
import { Settings } from "lucide-react";
import ModuleEntry_module_example from "../../../modules/venom-module-example/web-next/page";

export type OptionalModuleManifest = {
  schemaVersion: number;
  moduleId: string;
  displayName: string;
  routePath: string;
  featureFlagEnv: string | null;
  navLabel: string;
  navLabels: {
    pl: string;
    en: string;
    de: string;
  };
};

export type OptionalModuleNavItem = {
  href: string;
  label: string;
  labels: {
    pl: string;
    en: string;
    de: string;
  };
  icon: LucideIcon;
  featureFlagEnv?: string;
};

const OPTIONAL_MODULES: OptionalModuleManifest[] = [
  {
    schemaVersion: 1,
    moduleId: "module_example",
    displayName: "Module Example",
    routePath: "/module-example",
    featureFlagEnv: "NEXT_PUBLIC_FEATURE_MODULE_EXAMPLE",
    navLabel: "Module Example",
    navLabels: {
      pl: "Moduł przykładowy",
      en: "Module Example",
      de: "Beispielmodul",
    },
  }
];

const OPTIONAL_MODULE_COMPONENTS: Record<string, ComponentType | null> = {
  "module_example": ModuleEntry_module_example
};

function isEnvFlagEnabled(flagName: string): boolean {
  const raw = process.env[flagName] ?? "";
  if (!raw) {
    return false;
  }
  const normalized = raw.trim().toLowerCase();
  return normalized === "1" || normalized === "true" || normalized === "yes" || normalized === "on";
}

export function getOptionalModuleManifests(): OptionalModuleManifest[] {
  return OPTIONAL_MODULES.slice();
}

export function getEnabledOptionalModuleNavItems(): OptionalModuleNavItem[] {
  return OPTIONAL_MODULES.filter((moduleItem) => {
    if (!moduleItem.featureFlagEnv) {
      return true;
    }
    return isEnvFlagEnabled(moduleItem.featureFlagEnv);
  }).map((moduleItem) => ({
    href: moduleItem.routePath,
    label: moduleItem.navLabel,
    labels: moduleItem.navLabels,
    icon: Settings,
    featureFlagEnv: moduleItem.featureFlagEnv ?? undefined,
  }));
}

export function resolveOptionalModuleBySlug(slug: string): OptionalModuleManifest | null {
  const target = "/" + String(slug || "").replace(/^\/+/, "");
  for (const item of OPTIONAL_MODULES) {
    if (item.routePath === target) {
      return item;
    }
  }
  return null;
}

export function getOptionalModuleComponent(moduleId: string): ComponentType | null {
  return OPTIONAL_MODULE_COMPONENTS[moduleId] ?? null;
}
