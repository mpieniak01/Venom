{% extends "base.html" %}

{% block title %}Cockpit - Panel sterowania{% endblock %}

{% block nav_cockpit_active %}active{% endblock %}

{% block body_attrs %}data-layout="cockpit"{% endblock %}

{% block navbar %}{% endblock %}

{% block content %}
<div class="venom-ui-shell">
    <aside class="venom-sidebar">
        <div class="venom-sidebar__header">
            <div class="venom-brand">VENOM <span>OS</span></div>
            <div class="venom-sidebar__muted">v2.4.1 // UNIFIED</div>
            <div class="status-indicator">
                <span class="status-dot" id="connectionStatus"></span>
                <span id="statusText">≈ÅƒÖczenie...</span>
            </div>
        </div>
        <div class="venom-sidebar__content">
            <section class="venom-sidebar__section">
                <div class="venom-nav-title">Modu≈Çy g≈Ç√≥wne</div>
                <nav>
                    <a href="/" class="venom-nav-link active">
                        <span class="navbar-icon">üè†</span> Cockpit
                    </a>
                    <a href="/strategy" class="venom-nav-link">
                        <span class="navbar-icon">üéØ</span> Sala operacyjna
                    </a>
                    <a href="/flow-inspector" class="venom-nav-link">
                        <span class="navbar-icon">üîÄ</span> Inspektor przep≈Çyw√≥w
                    </a>
                    <a href="/inspector" class="venom-nav-link">
                        <span class="navbar-icon">üîç</span> Inspektor
                    </a>
                    <a href="/brain" class="venom-nav-link">
                        <span class="navbar-icon">üß†</span> M√≥zg
                    </a>
                </nav>
            </section>

            <section class="venom-sidebar__section">
                <div class="venom-nav-title">
                    <span>Telemetria</span>
                    <button id="clearLiveFeedBtn" class="btn-icon" type="button" title="Wyczy≈õƒá logi telemetrii">üóëÔ∏è</button>
                </div>
                <div class="venom-mini-terminal" id="liveFeed">
                    <div class="terminal-line terminal-line--accent">&gt; System zainicjalizowany.</div>
                    <div class="terminal-line terminal-line--muted">&gt; Oczekiwanie na zadania...</div>
                </div>
            </section>
        </div>
        <div class="venom-sidebar__footer">
            <section class="venom-sidebar__section venom-sidebar__section--guard">
                <div class="venom-nav-title">Stra≈º systemu</div>
                {% include '_system_guard_panel.html' %}
            </section>
        </div>
    </aside>

    <main class="venom-main">
        <header class="venom-top-header">
            <div class="venom-topline">// KONTROLA PANELU</div>
            <div class="venom-status-banner" id="repoStatus">
                <div class="status-pill status-pill--workspace">
                    <span class="status-pill__label">≈örodowisko</span>
                    <span class="status-pill__value workspace-path is-hidden" id="workspacePath">
                        {{ workspace_path|default('') }}
                    </span>
                    <div class="status-alert is-hidden" id="repoBannerMessage"></div>
                </div>
                <div class="status-pill status-pill--repo">
                    <span class="status-pill__label">Ga≈ÇƒÖ≈∫ / zmiany</span>
                    <div class="status-pill__value status-pill__value--split">
                        <span class="repo-branch" id="repoBranch">üåø <span id="branchName">-</span></span>
                        <span class="repo-changes" id="repoChanges">üü¢ <span id="changesText">Brak zmian</span></span>
                    </div>
                </div>
                <div class="status-pill status-pill--connection">
                    <span class="status-pill__label">Po≈ÇƒÖczenie</span>
                    <span class="status-pill__value">
                        <span class="status-dot" id="statusBannerDot"></span>
                        <span id="statusBannerText">≈ÅƒÖczenie...</span>
                    </span>
                </div>
                <div class="status-pill status-pill--actions">
                    <span class="status-pill__label">Akcje repozytorium</span>
                    <div class="repo-actions">
                        <button id="syncRepoBtn" class="btn-repo-action" title="Synchronizuj repozytorium">üîÑ</button>
                        <button id="undoChangesBtn" class="btn-repo-action" title="Cofnij wszystkie zmiany">‚Ü©Ô∏è</button>
                        <button id="initRepoBtn" class="btn-repo-action" title="Zainicjalizuj lokalne repozytorium">‚ú®</button>
                    </div>
                </div>
            </div>
        </header>

        <div class="cockpit-grid">
            <section class="cockpit-left-stack">
                <section class="cockpit-panel queue-tabs-panel queue-tabs-panel--nav">
                    <div class="panel-tabs top-panel-tabs">
                        <button class="tab-button active" data-tab="feed">üì° Transmisja</button>
                        <button class="tab-button" data-tab="voice">üé§ G≈Ços</button>
                        <button class="tab-button" data-tab="jobs">‚öôÔ∏è Zadania</button>
                        <button class="tab-button" data-tab="memory">üß† Pamiƒôƒá</button>
                        <button class="tab-button" data-tab="models">üî´ Modele</button>
                        <button class="tab-button" data-tab="history">üìú Historia</button>
                    </div>
                    <div class="tab-preferences">
                        <div class="tab-preferences__label">
                            <span>Domy≈õlna zak≈Çadka:</span>
                            <strong id="defaultTabLabel">Transmisja</strong>
                        </div>
                        <div class="tab-preferences__actions">
                            <button id="setDefaultTabBtn" class="btn-small" type="button" title="Ustaw aktualnƒÖ zak≈Çadkƒô jako domy≈õlnƒÖ">
                                ‚≠ê Ustaw obecnƒÖ
                            </button>
                            <button id="resetDefaultTabBtn" class="btn-small btn-reset" type="button" title="Przywr√≥ƒá domy≈õlnƒÖ zak≈Çadkƒô Transmisja">
                                ‚ôªÔ∏è Reset domy≈õlnej
                            </button>
                        </div>
                        <div class="tab-preferences__cta">
                            <button id="openPreferencesCenterBtn" class="btn-ghost" type="button" title="Zobacz i wyczy≈õƒá zapisane ustawienia Cockpitu">
                                ‚öôÔ∏è Centrum preferencji
                            </button>
                        </div>
                    </div>
                </section>

                <aside class="cockpit-panel cockpit-telemetry-panel">
                    <div class="tab-content active" id="feedTab">
                        <div class="telemetry-grid">
                            <section class="telemetry-section telemetry-section--metrics">
                                <div class="telemetry-section__header">
                                    <p class="venom-panel-eyebrow">Metryki sesji</p>
                                    <h3 class="venom-panel-title sr-only">Metryki sesji</h3>
                                </div>
                                <div class="telemetry-metrics-grid" id="metricsContainer">
                                    <article class="telemetry-metric-card">
                                        <span class="telemetry-metric-card__label">Zadania</span>
                                        <span class="telemetry-metric-card__value" id="metricTasks">0</span>
                                    </article>
                                    <article class="telemetry-metric-card">
                                        <span class="telemetry-metric-card__label">Sukces</span>
                                        <span class="telemetry-metric-card__value" id="metricSuccess">0%</span>
                                    </article>
                                    <article class="telemetry-metric-card">
                                        <span class="telemetry-metric-card__label">Uptime</span>
                                        <span class="telemetry-metric-card__value" id="metricUptime">0s</span>
                                    </article>
                                    <article class="telemetry-metric-card">
                                        <span class="telemetry-metric-card__label">Sieƒá I/O</span>
                                        <span class="telemetry-metric-card__value" id="metricNetwork">0 KB</span>
                                    </article>
                                </div>
                                <div class="telemetry-info-grid">
                                    <article class="telemetry-info-card">
                                        <p class="telemetry-info-card__label">Integracje</p>
                                        <div class="telemetry-info-card__body">
                                            <div class="telemetry-placeholder">
                                                <div class="integrations-matrix" id="integrationsMatrix">
                                                    <div class="loading-state">≈Åadowanie...</div>
                                                </div>
                                            </div>
                                        </div>
                                    </article>
                                    <article class="telemetry-info-card">
                                        <p class="telemetry-info-card__label">Aktywne operacje</p>
                                        <div class="telemetry-info-card__body">
                                            <div class="telemetry-placeholder">
                                                <div class="active-operations" id="activeOperations">
                                                    <div class="empty-state">Brak aktywnych operacji</div>
                                                </div>
                                            </div>
                                        </div>
                                    </article>
                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="tab-content" id="voiceTab">
                        <div class="telemetry-section voice-panel">
                            <div class="telemetry-section__header voice-panel__header">
                                <div>
                                    <p class="venom-panel-eyebrow">Centrum polece≈Ñ g≈Çosowych</p>
                                    <h3 class="venom-panel-title sr-only">Polecenia g≈Çosowe</h3>
                                </div>
                                <div class="voice-status" id="voiceStatus">
                                    <div class="status-indicator">
                                        <span class="status-dot" id="audioConnectionStatus"></span>
                                        <span id="audioStatusText">Roz≈ÇƒÖczony</span>
                                    </div>
                                </div>
                            </div>
                            <div class="voice-grid">
                                <section class="voice-control-panel">
                                    <button id="micButton" class="btn-mic" disabled>
                                        <span class="mic-icon">üé§</span>
                                        <span class="mic-text">Przytrzymaj i m√≥w</span>
                                    </button>
                                    <div class="voice-hint">Przytrzymaj przycisk, aby nagraƒá polecenie</div>
                                    <div class="audio-visualizer" id="audioVisualizer">
                                        <canvas id="visualizerCanvas" width="280" height="80"></canvas>
                                    </div>
                                </section>
                                <section class="voice-output-panel">
                                    <div class="transcription-box">
                                        <h4>Transkrypcja</h4>
                                        <div id="transcriptionText" class="transcription-text">Oczekiwanie na komendƒô g≈ÇosowƒÖ...</div>
                                    </div>
                                    <div class="response-box">
                                        <h4>Odpowied≈∫</h4>
                                        <div id="responseText" class="response-text">-</div>
                                    </div>
                                </section>
                                <section class="iot-panel">
                                    <div class="iot-panel__header">
                                        <div>
                                            <p class="venom-panel-eyebrow">Rider-Pi</p>
                                            <h4 class="venom-panel-title sr-only">Panel Rider-Pi</h4>
                                        </div>
                                        <button id="refreshIoTBtn" class="btn-small">üîÑ</button>
                                    </div>
                                    <div id="iotStatus" class="iot-status">
                                        <p class="empty-state">Po≈ÇƒÖczenie nieaktywne</p>
                                    </div>
                                    <div id="iotMetrics" class="iot-metrics">
                                        <div class="metric">
                                            <span class="metric-label">Temperatura CPU</span>
                                            <span class="metric-value" id="iotCpuTemp">--¬∞C</span>
                                        </div>
                                        <div class="metric">
                                            <span class="metric-label">Pamiƒôƒá</span>
                                            <span class="metric-value" id="iotMemory">--%</span>
                                        </div>
                                        <div class="metric">
                                            <span class="metric-label">Dysk</span>
                                            <span class="metric-value" id="iotDisk">--%</span>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="jobsTab">
                        <div class="telemetry-section jobs-panel">
                            <div class="telemetry-section__header jobs-panel__header">
                                <div>
                                    <p class="venom-panel-eyebrow">WglƒÖd w harmonogram</p>
                                    <h3 class="venom-panel-title sr-only">Zadania w tle</h3>
                                </div>
                                <div class="jobs-meta">
                                    <span>Ostatnie od≈õwie≈ºenie:</span>
                                    <strong id="jobsLastUpdated">-</strong>
                                </div>
                            </div>
                            <div class="jobs-insights" aria-label="Podsumowanie zada≈Ñ">
                                <article class="jobs-insight-card">
                                    <p class="jobs-insight-label">Widoczne zadania</p>
                                    <div class="jobs-insight-value" id="jobsVisibleCount">0</div>
                                    <p class="jobs-insight-subtitle">
                                        z <span id="jobsTotalCount">0</span> og√≥≈Çem
                                        <span id="jobsFilterSummary" class="jobs-filter-tag">Filtr: wszystkie</span>
                                    </p>
                                </article>
                                <article class="jobs-insight-card">
                                    <p class="jobs-insight-label">Uruchomione</p>
                                    <div class="jobs-insight-value" id="jobsRunningCount">0</div>
                                    <p class="jobs-insight-subtitle">status RUNNING / IN_PROGRESS (w toku)</p>
                                </article>
                                <article class="jobs-insight-card">
                                    <p class="jobs-insight-label">B≈Çƒôdy</p>
                                    <div class="jobs-insight-value" id="jobsFailedCount">0</div>
                                    <p class="jobs-insight-subtitle">status FAILED / ERROR (b≈ÇƒÖd)</p>
                                </article>
                            </div>
                            <div class="jobs-controls">
                                <div class="jobs-search">
                                    <input
                                        type="text"
                                        id="jobsSearchInput"
                                        placeholder="Szukaj po ID, typie lub opisie..."
                                        aria-label="Filtruj zadania schedulera"
                                    />
                                </div>
                                <div class="jobs-filters" role="tablist" aria-label="Filtr typ√≥w zada≈Ñ">
                                    <button type="button" class="jobs-filter-btn active" data-type="all">Wszystkie</button>
                                    <button type="button" class="jobs-filter-btn" data-type="interval">Interwa≈Çy</button>
                                    <button type="button" class="jobs-filter-btn" data-type="cron">Cron</button>
                                    <button type="button" class="jobs-filter-btn" data-type="date">Jednorazowe</button>
                                </div>
                                <div class="jobs-actions">
                                    <label class="jobs-auto">
                                        <input type="checkbox" id="jobsAutoRefreshToggle" checked />
                                        <span>Auto od≈õwie≈ºanie</span>
                                    </label>
                                    <div class="jobs-quick-actions">
                                        <button id="pauseJobsBtn" class="btn-small" title="Wstrzymaj scheduler">‚è∏Ô∏è</button>
                                        <button id="resumeJobsBtn" class="btn-small" title="Wzn√≥w scheduler">‚ñ∂Ô∏è</button>
                                        <button id="refreshJobsBtn" class="btn-small" title="Od≈õwie≈º dane">üîÑ</button>
                                        <button id="jobsResetFilters" class="btn-small btn-reset" type="button" title="Przywr√≥ƒá domy≈õlne filtry zada≈Ñ">
                                            ‚ôªÔ∏è Reset
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="jobs-section">
                                <h3>Aktywne zadania</h3>
                                <div id="jobsList" class="jobs-list">
                                    <p class="empty-state">≈Åadowanie zada≈Ñ...</p>
                                </div>
                            </div>
                            <div class="jobs-status-grid">
                                <article class="jobs-status-card">
                                    <div class="jobs-status-header">
                                        <p class="venom-panel-eyebrow">Harmonogram</p>
                                        <span class="jobs-status-pill" id="schedulerStatusPill">-</span>
                                    </div>
                                    <div id="schedulerStatus" class="jobs-status-body">
                                        <p class="empty-state">≈Åadowanie statusu...</p>
                                    </div>
                                </article>
                                <article class="jobs-status-card">
                                    <div class="jobs-status-header">
                                        <p class="venom-panel-eyebrow">Obserwator</p>
                                        <span class="jobs-status-pill" id="watcherStatusPill">-</span>
                                    </div>
                                    <div id="watcherStatus" class="jobs-status-body">
                                        <p class="empty-state">≈Åadowanie statusu...</p>
                                    </div>
                                </article>
                                <article class="jobs-status-card">
                                    <div class="jobs-status-header">
                                        <p class="venom-panel-eyebrow">Dokumentator</p>
                                        <span class="jobs-status-pill" id="documenterStatusPill">-</span>
                                    </div>
                                    <div id="documenterStatus" class="jobs-status-body">
                                        <p class="empty-state">≈Åadowanie statusu...</p>
                                    </div>
                                </article>
                                <article class="jobs-status-card">
                                    <div class="jobs-status-header">
                                        <p class="venom-panel-eyebrow">Ogrodnik</p>
                                        <span class="jobs-status-pill" id="gardenerStatusPill">-</span>
                                    </div>
                                    <div id="gardenerStatus" class="jobs-status-body">
                                        <p class="empty-state">≈Åadowanie statusu...</p>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="memoryTab">
                        <div class="telemetry-section memory-panel">
                            <div class="telemetry-section__header memory-panel__header">
                                <div>
                                    <p class="venom-panel-eyebrow">Bank wiedzy</p>
                                    <h3 class="venom-panel-title sr-only">Lekcje i pamiƒôƒá</h3>
                                </div>
                                <div class="memory-meta">
                                    <span>Ostatnie od≈õwie≈ºenie:</span>
                                    <strong id="memoryLastUpdated">-</strong>
                                </div>
                            </div>
                            <div class="memory-insights" aria-label="Podsumowanie pamiƒôci">
                                <article class="memory-insight-card">
                                    <p class="memory-insight-label">Widoczne lekcje</p>
                                    <div class="memory-insight-value" id="memoryVisibleLessons">0</div>
                                    <p class="memory-insight-subtitle">
                                        z <span id="memoryTotalLessons">0</span> og√≥≈Çem
                                        <span id="memoryFilterSummary" class="memory-filter-tag">Filtr: wszystkie</span>
                                    </p>
                                </article>
                                <article class="memory-insight-card">
                                    <p class="memory-insight-label">Sukcesy / B≈Çƒôdy</p>
                                    <div class="memory-insight-value memory-insight-value--split">
                                        <span id="memorySuccessCount">0</span>
                                        <span class="memory-insight-separator">/</span>
                                        <span id="memoryErrorCount">0</span>
                                    </div>
                                    <p class="memory-insight-subtitle">w bie≈ºƒÖcym widoku</p>
                                </article>
                                <article class="memory-insight-card">
                                    <p class="memory-insight-label">Graf wiedzy</p>
                                    <div class="memory-insight-value memory-insight-value--split">
                                        <span id="memoryGraphNodes">0</span>
                                        <span class="memory-insight-separator">wƒôz≈Çy</span>
                                        <span id="memoryGraphEdges">0</span>
                                        <span class="memory-insight-separator">krawƒôdzie</span>
                                    </div>
                                    <p class="memory-insight-subtitle">wg ostatniego skanu</p>
                                </article>
                            </div>
                            <div class="memory-controls">
                                <div class="memory-search">
                                    <input
                                        type="text"
                                        id="memorySearchInput"
                                        placeholder="Szukaj w lekcjach..."
                                        aria-label="Filtruj lekcje"
                                    />
                                </div>
                                <div class="memory-filters" role="tablist" aria-label="Filtry lekcji">
                                    <button type="button" class="memory-filter-btn active" data-status="all">Wszystkie</button>
                                    <button type="button" class="memory-filter-btn" data-status="success">Sukcesy</button>
                                    <button type="button" class="memory-filter-btn" data-status="error">B≈Çƒôdy</button>
                                </div>
                                <div class="memory-actions">
                                    <label class="memory-auto">
                                        <input type="checkbox" id="memoryAutoRefreshToggle" checked />
                                        <span>Auto od≈õwie≈ºanie</span>
                                    </label>
                                    <div class="memory-quick-actions">
                                        <button id="refreshLessons" class="btn-small">üîÑ Od≈õwie≈º lekcje</button>
                                        <button id="scanGraph" class="btn-small">üõ∞Ô∏è Zeskanuj graf</button>
                                        <button id="memoryResetFilters" class="btn-small btn-reset" type="button" title="Przywr√≥ƒá domy≈õlne filtry pamiƒôci">
                                            ‚ôªÔ∏è Reset
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="memory-body">
                                <section class="lessons-panel">
                                    <div class="memory-section-header">
                                        <h4>Ostatnie lekcje</h4>
                                    </div>
                                    <div id="lessonsList" class="lessons-list">
                                        <p class="empty-state">≈Åadowanie lekcji...</p>
                                    </div>
                                </section>
                                <section class="graph-panel">
                                    <div class="memory-section-header">
                                        <h4>Graf wiedzy</h4>
                                    </div>
                                    <div id="graphSummary" class="graph-summary">
                                        <p class="empty-state">≈Åadowanie grafu...</p>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="modelsTab">
                            <div class="telemetry-section models-panel">
                                <div class="telemetry-section__header models-panel__header">
                                    <div>
                                        <p class="venom-panel-eyebrow">Zbrojownia AI</p>
                                        <h3>üî´ Zbrojownia AI</h3>
                                    </div>
                                    <button id="refreshModels" class="btn-small" title="Od≈õwie≈º listƒô modeli">üîÑ</button>
                                </div>
                                <div class="models-insights" aria-label="Podsumowanie modeli">
                                    <article class="models-insight-card">
                                        <p class="models-insight-label">Zainstalowane</p>
                                        <div class="models-insight-value" id="modelsInstalledCount">0</div>
                                        <p class="models-insight-subtitle">Ostatnie od≈õwie≈ºenie: <span id="modelsLastUpdated">-</span></p>
                                    </article>
                                    <article class="models-insight-card">
                                        <p class="models-insight-label">Aktywne</p>
                                        <div class="models-insight-value" id="modelsActiveCount">0</div>
                                        <p class="models-insight-subtitle">Modele w u≈ºyciu</p>
                                    </article>
                                    <article class="models-insight-card">
                                        <p class="models-insight-label">≈ÅƒÖczny rozmiar</p>
                                        <div class="models-insight-value" id="modelsTotalSize">0 GB</div>
                                        <p class="models-insight-subtitle" id="modelsQuantSummary">Kwant: -</p>
                                    </article>
                                </div>
                                <div class="models-metrics-grid">
                                    <article class="models-metric-card">
                                        <span class="models-metric-card__label">CPU</span>
                                        <span class="models-metric-card__value" id="modelsCpuUsage">--%</span>
                                    </article>
                                <article class="models-metric-card">
                                    <span class="models-metric-card__label">GPU</span>
                                    <span class="models-metric-card__value" id="modelsGpuUsage">N/A</span>
                                </article>
                                <article class="models-metric-card">
                                    <span class="models-metric-card__label">RAM</span>
                                    <span class="models-metric-card__value" id="modelsRamUsage">-- / -- GB</span>
                                    <span class="models-metric-card__sub" id="modelsRamPercent">--%</span>
                                </article>
                                <article class="models-metric-card">
                                    <span class="models-metric-card__label">VRAM</span>
                                    <span class="models-metric-card__value" id="modelsVramUsage">-- / -- GB</span>
                                    <span class="models-metric-card__sub" id="modelsVramPercent">--%</span>
                                </article>
                                <article class="models-metric-card">
                                    <span class="models-metric-card__label">Dysk</span>
                                    <span class="models-metric-card__value" id="modelsDiskUsage">-- GB / -- GB</span>
                                    <span class="models-metric-card__sub" id="modelsDiskPercent">--%</span>
                                </article>
                                <article class="models-metric-card">
                                    <span class="models-metric-card__label">Modele</span>
                                    <span class="models-metric-card__value" id="modelsCount">0</span>
                                </article>
                            </div>
                            <section class="models-installer">
                                <div class="models-installer__header">
                                    <h4>üì• Instalator modeli</h4>
                                    <button id="unloadAllBtn" class="btn-emergency btn-emergency--ghost" title="Zwolnij wszystkie zasoby VRAM/RAM">
                                        üö® Zwolnij zasoby
                                    </button>
                                </div>
                                <div class="model-installer__form">
                                    <input
                                        type="text"
                                        id="modelNameInput"
                                        aria-label="Nazwa modelu do pobrania"
                                        placeholder="Nazwa modelu (np. llama3)"
                                        class="model-input"
                                    />
                                    <button id="installModelBtn" class="btn-small">
                                        üì• Pobierz
                                    </button>
                                </div>
                                <div id="downloadProgress" class="download-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Postƒôp pobierania modelu">
                                    <div class="download-progress__track">
                                        <div id="downloadProgressBar" class="download-progress__bar"></div>
                                    </div>
                                    <p id="downloadProgressText" class="download-progress__text">Pobieranie...</p>
                                </div>
                            </section>
                            <section class="models-list-panel">
                                <div class="memory-section-header">
                                    <h4>Aktywne modele</h4>
                                </div>
                                <div class="models-list" id="modelsList">
                                    <p class="empty-state">≈Åadowanie modeli...</p>
                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="tab-content" id="historyTab">
                        <div class="telemetry-section history-panel">
                            <div class="telemetry-section__header history-panel__header">
                                <div>
                                    <p class="venom-panel-eyebrow">O≈õ czasu</p>
                                    <h3>üìú Historia zada≈Ñ</h3>
                                </div>
                                <div class="history-meta">
                                    <span>Ostatnie od≈õwie≈ºenie:</span>
                                    <strong id="historyLastUpdated">-</strong>
                                </div>
                            </div>
                            <div class="history-controls">
                                <div class="history-search">
                                    <input
                                        type="text"
                                        id="historySearchInput"
                                        placeholder="Szukaj po ID lub poleceniu..."
                                        aria-label="Filtruj historiƒô zada≈Ñ"
                                    />
                                </div>
                                <div class="history-filters" role="tablist" aria-label="Filtry status√≥w historii">
                                    <button type="button" class="history-filter-btn active" data-status="all">Wszystkie</button>
                                    <button type="button" class="history-filter-btn" data-status="pending">OczekujƒÖce</button>
                                    <button type="button" class="history-filter-btn" data-status="processing">W toku</button>
                                    <button type="button" class="history-filter-btn" data-status="completed">Zako≈Ñczone</button>
                                    <button type="button" class="history-filter-btn" data-status="failed">B≈Çƒôdy</button>
                                </div>
                                <div class="history-actions">
                                    <label class="history-auto">
                                        <input type="checkbox" id="historyAutoRefreshToggle" checked />
                                        <span>Auto od≈õwie≈ºanie</span>
                                    </label>
                                    <div class="history-action-buttons">
                                        <button id="refreshHistory" class="btn-small">üîÑ Od≈õwie≈º</button>
                                        <button id="historyResetFilters" class="btn-small btn-reset" type="button" title="Przywr√≥ƒá domy≈õlne filtry historii">
                                            ‚ôªÔ∏è Reset
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="history-insights">
                                <article class="history-insight-card">
                                    <span class="history-insight-card__label">≈ªƒÖdania</span>
                                    <strong class="history-insight-card__value" id="historyTotalCount">0</strong>
                                    <span class="history-insight-card__sub">Bie≈ºƒÖce filtrowanie</span>
                                </article>
                                <article class="history-insight-card">
                                    <span class="history-insight-card__label">Sukcesy</span>
                                    <strong class="history-insight-card__value" id="historySuccessCount">0</strong>
                                    <span class="history-insight-card__sub" id="historySuccessRate">0%</span>
                                </article>
                                <article class="history-insight-card" id="historyFailedCard">
                                    <span class="history-insight-card__label">B≈Çƒôdy</span>
                                    <strong class="history-insight-card__value" id="historyFailedCount">0</strong>
                                    <span class="history-insight-card__sub">
                                        Z ostatnich <span id="historySampleSize">0</span>
                                    </span>
                                </article>
                                <article class="history-insight-card">
                                    <span class="history-insight-card__label">≈ör. czas</span>
                                    <strong class="history-insight-card__value" id="historyAvgDuration">-</strong>
                                    <span class="history-insight-card__sub">na zadanie</span>
                                </article>
                            </div>
                            <div class="history-table-wrapper">
                                <table class="history-table" id="historyTable">
                                    <thead>
                                        <tr>
                                            <th>Status</th>
                                            <th>Polecenie</th>
                                            <th>Czas</th>
                                        </tr>
                                    </thead>
                                    <tbody id="historyTableBody">
                                        <tr>
                                            <td colspan="3" class="empty-state">≈Åadowanie historii...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </aside>
            </section>

            <section class="cockpit-right-stack">
                <section class="cockpit-panel queue-governance-panel" aria-labelledby="queuePanelTitle">
                    <div class="venom-panel-header queue-panel-header">
                        <div>
                            <p class="venom-panel-eyebrow">ZarzƒÖdzanie kolejkƒÖ</p>
                            <h2 id="queuePanelTitle" class="venom-panel-title sr-only">ZarzƒÖdzanie kolejkƒÖ</h2>
                        </div>
                        <div class="governance-header-actions">
                            <button id="emergencyStopBtn" class="btn-emergency" title="Awaryjne zatrzymanie - anuluj wszystkie zadania">
                                üö® Awaryjne zatrzymanie
                            </button>
                        </div>
                    </div>
                    <div class="governance-summary">
                        <article class="governance-card">
                            <span class="governance-card__label">Aktywne zadania</span>
                            <div class="governance-card__value">
                                <span id="queueActive">0</span>
                                <span class="governance-card__limit">/ <span id="queueLimit">5</span></span>
                            </div>
                            <div class="governance-card__actions">
                                <button id="pauseResumeBtn" class="btn-queue-action pause" data-state="running">
                                    <span class="btn-icon">‚è∏Ô∏è</span>
                                    <span class="btn-text">PAUZA</span>
                                </button>
                            </div>
                        </article>
                        <article class="governance-card">
                            <span class="governance-card__label">Zadania w kolejce</span>
                            <div class="governance-card__value" id="queuePending">0</div>
                            <div class="governance-card__actions">
                                <button id="purgeQueueBtn" class="btn-queue-action danger">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                    <span class="btn-text">WYCZY≈öƒÜ KOLEJKƒò</span>
                                </button>
                            </div>
                        </article>
                        <article class="governance-card governance-card--tokenomics">
                            <span class="governance-card__label">Koszt sesji</span>
                            <div class="governance-card__value" id="sessionCost">$0.00</div>
                            <p class="governance-footnote">Monitoruj koszt aby uniknƒÖƒá nieplanowanych wydatk√≥w.</p>
                        </article>
                    </div>
                </section>

                <section class="cockpit-panel venom-panel-card">
                    <div class="venom-panel-header venom-panel-header--tight">
                        <p class="venom-panel-eyebrow">Aktywne zadania</p>
                        <h2 class="venom-panel-title sr-only">Aktywne zadania</h2>
                    </div>
                    <div class="venom-task-list" id="taskList">
                        <p class="empty-state">Brak aktywnych zada≈Ñ</p>
                    </div>
                </section>

                <section class="cockpit-panel venom-console-panel">
                    <div class="venom-panel-header">
                        <p class="venom-panel-eyebrow">Konsola czatu</p>
                        <h2 class="venom-panel-title sr-only">Konsola czatu</h2>
                        <button id="clearWidgetsBtn" class="btn-small" title="Wyczy≈õƒá widgety">üóëÔ∏è Wyczy≈õƒá widgety</button>
                    </div>
                    <div class="venom-console__body">
                        <div class="chat-container">
                            <div class="chat-scroll-area" id="chatScrollArea">
                                <div class="chat-messages" id="chatMessages"></div>
                                <div class="widgets-grid" id="widgetsGrid"></div>
                            </div>
                            <div class="suggestion-panel" id="suggestionPanel" aria-label="Przybornik polece≈Ñ">
                                <div class="suggestion-grid">
                                    <button type="button" class="suggestion-chip" data-prompt="Stw√≥rz logo dla fintechu u≈ºywajƒÖc DALL-E" aria-label="Kreacja: Stw√≥rz logo dla fintechu z DALL-E">
                                        <span class="chip-icon" aria-hidden="true">üé®</span>
                                        <span class="chip-text-block">
                                            <span class="chip-title">Kreacja</span>
                                            <span class="chip-desc">"Stw√≥rz logo dla fintechu u≈ºywajƒÖc DALL-E"</span>
                                        </span>
                                    </button>
                                    <button type="button" class="suggestion-chip" data-prompt="Sprawd≈∫ status serwer√≥w w infrastrukturze" aria-label="DevOps: Sprawd≈∫ status serwer√≥w">
                                        <span class="chip-icon" aria-hidden="true">‚òÅÔ∏è</span>
                                        <span class="chip-text-block">
                                            <span class="chip-title">DevOps</span>
                                            <span class="chip-desc">"Sprawd≈∫ status serwer√≥w w infrastrukturze"</span>
                                        </span>
                                    </button>
                                    <button type="button" class="suggestion-chip" data-prompt="Poka≈º status projektu" aria-label="ZarzƒÖd: Status projektu i roadmapy">
                                        <span class="chip-icon" aria-hidden="true">üìä</span>
                                        <span class="chip-text-block">
                                            <span class="chip-title">Status projektu</span>
                                            <span class="chip-desc">"Poka≈º status projektu"</span>
                                        </span>
                                    </button>
                                    <button type="button" class="suggestion-chip" data-prompt="Zr√≥b research o trendach AI w 2024" aria-label="Badania: Zr√≥b research o trendach AI w 2024">
                                        <span class="chip-icon" aria-hidden="true">üß†</span>
                                        <span class="chip-text-block">
                                            <span class="chip-title">Research</span>
                                            <span class="chip-desc">"Zr√≥b research o trendach AI w 2024"</span>
                                        </span>
                                    </button>
                                    <button type="button" class="suggestion-chip" data-prompt="Napisz testy jednostkowe dla modu≈Çu API" aria-label="Kod: Napisz testy jednostkowe dla modu≈Çu API">
                                        <span class="chip-icon" aria-hidden="true">üõ†Ô∏è</span>
                                        <span class="chip-text-block">
                                            <span class="chip-title">Kod</span>
                                            <span class="chip-desc">"Napisz testy jednostkowe dla modu≈Çu API"</span>
                                        </span>
                                    </button>
                                    <button type="button" class="suggestion-chip" data-prompt="Co potrafisz?" aria-label="Pomoc: Co potrafisz? Poka≈º funkcje">
                                        <span class="chip-icon" aria-hidden="true">‚ùì</span>
                                        <span class="chip-text-block">
                                            <span class="chip-title">Pomoc</span>
                                            <span class="chip-desc">"Co potrafisz?"</span>
                                        </span>
                                    </button>
                                </div>
                            </div>
                            <div class="chat-input-container">
                                <textarea
                                    id="taskInput"
                                    rows="3"
                                    placeholder="Wpisz polecenie dla Venoma... (np. 'Zr√≥b research o Python 3.12')"
                                ></textarea>
                                <div class="chat-input-actions">
                                    <label class="lab-mode-toggle" title="Tryb Lab - zadania nie zapisujƒÖ lekcji do pamiƒôci">
                                        <input type="checkbox" id="labModeCheckbox" />
                                        <span class="lab-mode-icon">üß™</span>
                                        <span class="lab-mode-text">Tryb Lab</span>
                                    </label>
                                    <button id="sendButton" class="btn-venom">
                                        <span>Wy≈õlij</span>
                                        <kbd>Ctrl+Enter</kbd>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </section>
        </div>
    </main>
</div>

<div id="historyModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="historyModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="historyModalTitle">üîç Szczeg√≥≈Çy Zadania</h2>
            <button class="modal-close" id="closeHistoryModal" aria-label="Zamknij modal">&times;</button>
        </div>
        <div class="modal-body" id="historyModalBody">
            <div class="loading-state">≈Åadowanie...</div>
        </div>
    </div>
</div>

<div id="costModeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="costModeModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="costModeModalTitle">üí∏ W≈ÇƒÖczenie Trybu Pro (tryb p≈Çatny)</h2>
            <button class="modal-close" id="closeCostModeModal" aria-label="Zamknij modal">&times;</button>
        </div>
        <div class="modal-body">
            <p>Aktywacja Trybu Pro pozwala na korzystanie z modeli p≈Çatnych oraz zasob√≥w kosztowych.</p>
            <p>Czy na pewno chcesz kontynuowaƒá?</p>
        </div>
        <div class="modal-actions">
            <button id="confirmCostMode" class="btn-primary">‚úÖ Tak, w≈ÇƒÖcz Tryb Pro</button>
            <button id="cancelCostMode" class="btn-secondary">‚ùå Anuluj</button>
        </div>
    </div>
</div>

<div id="preferencesModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="preferencesModalTitle">
    <div class="modal-content modal-content--wide">
        <div class="modal-header">
            <h2 id="preferencesModalTitle">‚öôÔ∏è Centrum preferencji</h2>
            <button class="modal-close" id="closePreferencesModal" aria-label="Zamknij modal">&times;</button>
        </div>
        <div class="modal-body">
            <p class="modal-description">
                Podsumowanie zachowanych ustawie≈Ñ Cockpitu i pozosta≈Çych modu≈Ç√≥w. W ka≈ºdej chwili mo≈ºesz je wyczy≈õciƒá,
                aby wr√≥ciƒá do domy≈õlnej konfiguracji.
            </p>
            <div class="preferences-modal-grid">
                <section class="preferences-section">
                    <h3 class="preferences-section__title">Cockpit</h3>
                    <div id="preferencesSummary" class="preferences-list"></div>
                </section>
                <section class="preferences-section">
                    <h3 class="preferences-section__title">Pozosta≈Çe modu≈Çy</h3>
                    <div id="externalPreferencesSummary" class="preferences-list"></div>
                </section>
            </div>
            <div class="preferences-transfer">
                <section class="preferences-transfer__panel">
                    <h3 class="preferences-transfer__title">Eksport ustawie≈Ñ</h3>
                    <textarea id="preferencesExportPayload" class="preferences-transfer__textarea" readonly></textarea>
                    <div class="preferences-transfer__actions">
                        <button id="copyPreferencesExportBtn" class="btn-small" type="button">
                            üìã Kopiuj JSON
                        </button>
                        <button id="refreshPreferencesExportBtn" class="btn-small btn-reset" type="button">
                            üîÑ Od≈õwie≈º podglƒÖd
                        </button>
                        <button id="downloadPreferencesExportBtn" class="btn-small btn-secondary" type="button">
                            üíæ Pobierz plik
                        </button>
                    </div>
                </section>
                <section class="preferences-transfer__panel">
                    <h3 class="preferences-transfer__title">Import ustawie≈Ñ</h3>
                    <textarea
                        id="preferencesImportInput"
                        class="preferences-transfer__textarea"
                        placeholder='Wklej JSON wygenerowany z Venoma (np. {"cockpit":{...}})'
                    ></textarea>
                    <div class="preferences-file-upload">
                        <input
                            type="file"
                            id="preferencesImportFileInput"
                            accept="application/json,.json"
                            aria-label="Wybierz plik JSON z preferencjami"
                        />
                        <label for="preferencesImportFileInput" class="btn-small btn-secondary" role="button">
                            üìÇ Wybierz plik
                        </label>
                        <span id="preferencesImportFileName" class="preferences-file-upload__name">
                            Brak wybranego pliku
                        </span>
                    </div>
                    <div class="preferences-transfer__actions">
                        <button id="applyPreferencesImportBtn" class="btn-primary" type="button">
                            üì• Wczytaj JSON
                        </button>
                    </div>
                    <p class="preferences-import__hint">
                        Import nadpisze zapisane ustawienia (zak≈Çadki, filtry, tryby auto-refresh) i od≈õwie≈ºy stronƒô.
                    </p>
                </section>
            </div>
        </div>
        <div class="modal-actions modal-actions--spaced">
            <button id="resetCockpitPreferencesBtn" class="btn-secondary" type="button">
                ‚ôªÔ∏è Wyczy≈õƒá Cockpit
            </button>
            <button id="resetExternalPreferencesBtn" class="btn-secondary" type="button">
                üßπ Wyczy≈õƒá modu≈Çy
            </button>
            <button id="resetAllPreferencesBtn" class="btn-primary" type="button">
                üî• Wyczy≈õƒá wszystko
            </button>
        </div>
    </div>
</div>
{% endblock %}
